<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¸¶ä¾†å¹¸ç¦çš„ç¤¾äº¤SOP</title>
    <style>
        /* --- å…¨å±€è¨­å®š --- */
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            font-family: "Microsoft JhengHei", "PingFang TC", sans-serif;
            overflow: hidden;
            /* é è¨­èƒŒæ™¯ï¼Œå¹³æ™‚æœƒè¢«æ³¡æ³¡è¦†è“‹ */
            background: linear-gradient(180deg, #ffd1ff 0%, #c4dafa 100%);
        }

        /* --- èƒŒæ™¯å®¹å™¨ (æ”¾æ³¡æ³¡ç”¨çš„) --- */
        #background-container {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1;
            overflow: hidden;
            pointer-events: none;
        }

        /* --- ç¢ç´™èŠ±å®¹å™¨ (æ”¾æ­¡æ¨‚å‹•ç•«ç”¨çš„) --- */
        #confetti-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 20; /* æ¯”å¡ç‰‡æ›´é«˜å±¤ç´š */
            overflow: hidden;
            pointer-events: none; /* ä¸é˜»æ“‹é»æ“Š */
            display: none; /* é è¨­éš±è— */
        }

        /* --- æ³¡æ³¡å‹•ç•«åŸºç¤è¨­å®š --- */
        .bubble {
            position: absolute;
            bottom: -100px;
            background: radial-gradient(circle at 30% 30%, rgba(255, 255, 255, 0.8), rgba(255, 255, 255, 0.1));
            border-radius: 50%;
            box-shadow: 0 0 15px rgba(255, 255, 255, 0.5);
            animation: floatUp linear infinite;
            z-index: 2;
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        @keyframes floatUp {
            0% { transform: translateY(0) scale(1); opacity: 0; }
            10% { opacity: 0.9; }
            100% { transform: translateY(-120vh) scale(1.1); opacity: 0; }
        }

        /* --- ç¢ç´™èŠ±å‹•ç•«è¨­å®š (èŠå¤©ç”¨) --- */
        .confetti {
            position: absolute;
            width: 10px;
            height: 10px;
            opacity: 0.8;
        }

        @keyframes confettiFall {
            0% { transform: translateY(-10vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(110vh) rotate(720deg); opacity: 0; }
        }

        /* --- ã€æ–°å¢ã€‘å¹³éœæµå‹•å‹•ç•«è¨­å®š (å¹³éœç”¨) --- */
        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- éŠæˆ²ä¸»å®¹å™¨ --- */
        #game-container {
            position: relative;
            z-index: 10;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100%;
            width: 100%;
            padding: 20px;
            box-sizing: border-box;
        }

        /* --- å¡ç‰‡æ¨£å¼ (ä¸€èˆ¬å•é¡Œæ¨¡å¼) --- */
        .card {
            background: rgba(255, 255, 255, 0.35); 
            backdrop-filter: blur(20px); 
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.15);
            
            padding: 40px;
            border-radius: 24px;
            max-width: 600px;
            width: 100%;
            text-align: center;
            transition: all 0.5s ease;
            position: relative;
        }

        /* --- æ»¿ç‰ˆæ¨£å¼ (çµæœæ¨¡å¼é€šç”¨) --- */
        .card.fullscreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            max-width: none;
            border-radius: 0;
            border: none;
            box-shadow: none;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            z-index: 15; /* ç¢ºä¿åœ¨æ³¡æ³¡ä¹‹ä¸Š */
            transition: background 1s ease; /* è®“èƒŒæ™¯åˆ‡æ›æ›´æŸ”å’Œ */
        }

        /* --- ç‰¹æ®ŠçµæœèƒŒæ™¯è¨­å®š --- */
        
        /* ã€ä¿®æ”¹ã€‘å¹³éœçµæœèƒŒæ™¯ï¼šåŠ å…¥æŸ”å’Œæµå‹•å‹•ç•« */
        .card.fullscreen.theme-calm {
             /* ä½¿ç”¨æŸ”å’Œçš„ç´«è—è‰²æ¼¸å±¤ï¼Œä¸¦è¨­å®šç‚º 200% å¤§å°ä»¥ä¾¿ç§»å‹• */
             background: linear-gradient(135deg, rgba(209, 196, 233, 0.9) 0%, rgba(179, 229, 252, 0.9) 100%);
             background-size: 200% 200%;
             backdrop-filter: blur(10px);
             /* å¥—ç”¨ç·©æ…¢æµå‹•çš„å‹•ç•« */
             animation: gradientShift 15s ease infinite;
        }

        /* èŠå¤©çµæœèƒŒæ™¯ (å……æ»¿å¹¸ç¦çš„ç²‰ç´…è‰²) */
        .card.fullscreen.theme-chat {
            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 50%, #ffd1ff 100%);
        }

        /* æ¨™é¡Œèˆ‡æ–‡å­— */
        .card h2 {
            color: #4a4a4a;
            margin-bottom: 25px;
            font-size: 1.6rem;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(255,255,255,0.5);
        }

        .card p {
            color: #555;
            margin-bottom: 35px;
            font-size: 1.1rem;
            line-height: 1.7;
            font-weight: 500;
            max-width: 600px;
        }

        .card.fullscreen h2 {
            font-size: 2.2rem;
            margin-bottom: 30px;
        }

        /* --- æŒ‰éˆ•ç¾¤çµ„ --- */
        .btn-group {
            display: flex;
            flex-direction: row;
            justify-content: center;
            gap: 20px;
            width: 100%;
            max-width: 600px;
        }

        /* --- æŒ‰éˆ•æ¨£å¼ --- */
        button {
            flex: 1;
            background: rgba(255, 117, 140, 0.9);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.4);
            padding: 16px 20px;
            font-size: 1rem;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: bold;
            box-shadow: 0 4px 15px rgba(255, 117, 140, 0.3);
            white-space: normal;
            line-height: 1.4;
            min-width: 120px;
        }

        button:hover {
            background: rgba(255, 94, 120, 1);
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(255, 117, 140, 0.5);
        }

        button:active {
            transform: translateY(1px);
        }

        /* æ¬¡è¦æŒ‰éˆ• (å†æ¸¬ä¸€æ¬¡) */
        button.secondary {
            background: rgba(166, 193, 238, 0.9);
            box-shadow: 0 4px 15px rgba(166, 193, 238, 0.4);
            max-width: 300px;
        }
        
        button.secondary:hover {
            background: rgba(132, 169, 229, 1);
        }

        /* --- è½‰å ´å‹•ç•« --- */
        .fade-in {
            animation: fadeIn 0.6s cubic-bezier(0.22, 1, 0.36, 1);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        /* --- RWD æ‰‹æ©Ÿç‰ˆèª¿æ•´ --- */
        @media (max-width: 480px) {
            .btn-group {
                flex-direction: column;
                width: 100%;
            }
            .card {
                padding: 30px 20px;
            }
            .card.fullscreen h2 {
                font-size: 1.8rem;
            }
            .home-btn {
                top: 15px; left: 15px;
                padding: 8px 16px;
                font-size: 0.8rem;
            }
        }

        /* --- HOME BUTTON --- */
        .home-btn {
            position: fixed;
            top: 30px;
            left: 30px;
            z-index: 100;
            padding: 12px 24px;
            background: rgba(255, 255, 255, 0.25);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: 99px;
            color: #555;
            font-weight: 700;
            font-size: 0.9rem;
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0,0,0,0.05);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .home-btn:hover {
            background: rgba(255, 255, 255, 0.6);
            transform: translateX(-3px);
            box-shadow: 0 6px 20px rgba(255, 105, 180, 0.15);
            color: #e84393;
        }
    </style>
</head>
<body>

    <div id="background-container"></div>
    <div id="confetti-container"></div>

    <!-- Home Button -->
    <a href="index.html" class="home-btn">â† BACK TO TRUEMORE</a>

    <div id="game-container">
        <div id="card" class="card fade-in">
            </div>
    </div>

    <script>
        // --- æ³¡æ³¡èƒŒæ™¯ç”Ÿæˆ (å¸¸é§) ---
        function createBubbles() {
            const container = document.getElementById('background-container');
            const bubbleCount = 30; 
            for (let i = 0; i < bubbleCount; i++) {
                const bubble = document.createElement('div');
                bubble.classList.add('bubble');
                const size = Math.random() * 80 + 20; 
                bubble.style.width = `${size}px`;
                bubble.style.height = `${size}px`;
                bubble.style.left = `${Math.random() * 100}%`;
                const duration = Math.random() * 8 + 6; 
                const delay = Math.random() * 5;
                bubble.style.animationDuration = `${duration}s`;
                bubble.style.animationDelay = `${delay}s`;
                container.appendChild(bubble);
            }
        }
        createBubbles();

        // --- æ­¡æ¨‚ç¢ç´™èŠ±å‹•ç•«æ§åˆ¶ (èŠå¤©ç”¨) ---
        const confettiContainer = document.getElementById('confetti-container');
        let confettiInterval;

        function startConfetti() {
            confettiContainer.style.display = 'block';
            confettiContainer.innerHTML = ''; 

            const colors = ['#ff5e57', '#ffdd59', '#05c46b', '#0fbcf9', '#d63031', '#e84393', '#ffffff'];

            for (let i = 0; i < 150; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.width = Math.random() * 12 + 6 + 'px';
                confetti.style.height = Math.random() * 12 + 6 + 'px';
                confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                
                const duration = Math.random() * 4 + 3; 
                const delay = Math.random() * 3; 
                confetti.style.animation = `confettiFall ${duration}s linear infinite ${delay}s`;
                confetti.style.transform = `rotate(${Math.random() * 360}deg)`;
                
                confettiContainer.appendChild(confetti);
            }
        }

        function stopConfetti() {
            confettiContainer.style.display = 'none';
            confettiContainer.innerHTML = ''; 
        }


        // --- ç¯€é»è³‡æ–™ ---
        const nodes = {
            intro: {
                title: "å¸¶ä¾†å¹¸ç¦çš„ç¤¾äº¤ SOP",
                desc: "ç”Ÿæ´»å……æ–¥è‘—é›£ä»¥é¿å…çš„ç¤¾äº¤å—ï¼Ÿ<br>é‚€è«‹æƒ³èˆ‡ä½ ç¤¾äº¤çš„å°è±¡ï¼Œä¸€èµ·è©•ä¼°ä½ æ˜¯å¦èƒ½ç¶­æŒå…§å¿ƒå¹³éœå§ã€‚",
                options: [
                    { text: "é–‹å§‹è©•ä¼°", next: "q_small_talk" }
                ]
            },
            q_small_talk: {
                title: "æ˜¯é–’èŠå—ï¼Ÿ",
                desc: "ç¢ºèªå°è©±çš„æ€§è³ªæ˜¯è¼•é¬†çš„é‚„æ˜¯åš´è‚…çš„ã€‚",
                options: [
                    { text: "ä¸æ˜¯ï¼Œæœ‰æ­£äº‹", next: "q_my_fault" },
                    { text: "æ˜¯ï¼Œåªæ˜¯é–’èŠ", next: "q_scolded" } 
                ]
            },
            q_scolded: {
                title: "æœ‰äººæœƒè¢«ç½µå—ï¼Ÿ",
                desc: "é åˆ¤é€™å ´å°è©±çš„æ°£æ°›èµ°å‘...",
                options: [
                    { text: "æ²’æœ‰äººè¢«ç½µ", next: "q_tired" },
                    { text: "æœ‰ï¼Œå°æ–¹æƒ³è¦ç™¼ç‰¢é¨·æ”¾é¬†", next: "res_calm" }
                ]
            },
            q_my_fault: {
                title: "æ˜¯æˆ‘é€ æˆçš„å—ï¼Ÿ",
                desc: "é—œæ–¼äº‹æƒ…çš„èµ·å› èˆ‡è²¬ä»»...",
                options: [
                    { text: "ä¸æ˜¯æˆ‘", next: "res_calm" },
                    { text: "æ˜¯æˆ‘é€ æˆçš„", next: "q_meds" }
                ]
            },
            q_tired: {
                title: "æˆ‘ç¾åœ¨ç´¯å—ï¼Ÿ",
                desc: "èª å¯¦é¢å°è‡ªå·±çš„èƒ½é‡ç‹€æ…‹ã€‚",
                options: [
                    { text: "æœ‰é»ç´¯äº†", next: "res_calm" },
                    { text: "æˆ‘ä¸ç´¯", next: "res_chat" }
                ]
            },
            q_meds: {
                title: "èº«å¿ƒç‹€æ…‹æª¢è¦–",
                desc: "å°æ–¹æˆ–æˆ‘æœ‰ç”¨è—¥ï¼Œæˆ–ç²¾ç¥ä¸å¥½å—ï¼Ÿ",
                options: [
                    { text: "ç‹€æ…‹æ¬ ä½³", next: "res_calm" },
                    { text: "ç‹€æ³è‰¯å¥½", next: "q_trouble" }
                ]
            },
            q_trouble: {
                title: "å¦‚æœä¸è¨è«–çš„è©±...",
                desc: "å°æ–¹æœƒå› æ­¤æ„Ÿåˆ°å¾ˆå›°æ“¾å—ï¼Ÿ",
                options: [
                    { text: "ä¸æœƒå›°æ“¾", next: "res_calm" },
                    { text: "æœƒå¾ˆå›°æ“¾", next: "res_chat" }
                ]
            },
            // --- çµæœé é¢ ---
            res_calm: {
                type: "result",
                theme: "calm",
                title: "âœ¨ æˆ‘æƒ³ä¿æŒå…§å¿ƒå¹³éœ âœ¨",
                desc: "ç¾åœ¨å¯èƒ½ä¸æ˜¯ç¤¾äº¤çš„æœ€ä½³æ™‚æ©Ÿã€‚<br>ä¿è­·è‡ªå·±çš„èƒ½é‡ï¼Œç¦®è²Œåœ°çµæŸæˆ–å»¶å¾Œå°è©±ï¼Œè®“è‡ªå·±å›åˆ°å¹³éœçš„ç‹€æ…‹ã€‚",
                options: [
                    { text: "å†æ¸¬ä¸€æ¬¡", next: "intro", style: "secondary" }
                ]
            },
            res_chat: {
                type: "result",
                theme: "chat",
                title: "ğŸ‰ é‚£ä¾†èŠå¤©å§ï¼ ğŸ‰",
                desc: "ç¾åœ¨çš„ç‹€æ…‹å¾ˆé©åˆäº¤æµï¼<br>äº«å—é€™å ´å°è©±ï¼Œæˆ–è¨±æœƒæœ‰æ„æƒ³ä¸åˆ°çš„æ”¶ç©«å–”ã€‚",
                options: [
                    { text: "å†æ¸¬ä¸€æ¬¡", next: "intro", style: "secondary" }
                ]
            }
        };

        const card = document.getElementById('card');

        function renderNode(nodeKey) {
            const node = nodes[nodeKey];
            
            // 1. æ¸…ç†å·¥ä½œï¼šåœæ­¢æ‰€æœ‰ç‰¹æ®Šå‹•ç•«ï¼Œç§»é™¤èˆŠ class
            stopConfetti();
            card.classList.remove('fullscreen', 'theme-calm', 'theme-chat');
            // ç§»é™¤å¯èƒ½å­˜åœ¨çš„è¡Œå…§æ¨£å¼å‹•ç•«(ä»¥é˜²è¬ä¸€)
            card.style.animation = ''; 
            
            // 2. é‡ç½®å¡ç‰‡å…§å®¹èˆ‡è½‰å ´å‹•ç•«
            card.innerHTML = '';
            card.classList.remove('fade-in');
            void card.offsetWidth; // Trigger reflow
            card.classList.add('fade-in');

            // 3. åˆ¤æ–·æ˜¯å¦ç‚ºçµæœé é¢ï¼Œä¸¦å¥—ç”¨å°æ‡‰æ¨£å¼èˆ‡å‹•ç•«
            if (node.type === 'result') {
                card.classList.add('fullscreen');
                // åŠ ä¸Šä¸»é¡Œ class ä»¥ä¾¿ CSS è®Šæ›´èƒŒæ™¯è‰²
                card.classList.add(`theme-${node.theme}`);

                // å¦‚æœæ˜¯èŠå¤©çµæœï¼Œå•Ÿå‹•æ­¡æ¨‚å‹•ç•«
                if (node.theme === 'chat') {
                    startConfetti();
                }
                // å¦‚æœæ˜¯å¹³éœçµæœï¼ŒCSS æœƒè‡ªå‹•å¥—ç”¨ gradientShift å‹•ç•«
            }

            // 4. å»ºç«‹æ¨™é¡Œèˆ‡å…§å®¹
            const h2 = document.createElement('h2');
            h2.innerHTML = node.title;
            if (node.type === 'result') {
                // çµæœé æ¨™é¡Œé¡è‰²å¾®èª¿
                h2.style.color = node.theme === 'calm' ? '#8e44ad' : '#ff5e57';
            }
            card.appendChild(h2);

            if (node.desc) {
                const p = document.createElement('p');
                p.innerHTML = node.desc;
                card.appendChild(p);
            }

            // 5. å»ºç«‹æŒ‰éˆ•
            const btnGroup = document.createElement('div');
            btnGroup.className = 'btn-group';

            node.options.forEach(option => {
                const btn = document.createElement('button');
                btn.innerText = option.text;
                if (option.style === 'secondary') {
                    btn.classList.add('secondary');
                }
                
                btn.onclick = () => {
                    renderNode(option.next);
                };
                btnGroup.appendChild(btn);
            });

            card.appendChild(btnGroup);
        }

        // å•Ÿå‹•éŠæˆ²
        renderNode('intro');

    </script>
</body>
</html>